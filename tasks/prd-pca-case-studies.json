{
  "project": "ace-prep",
  "feature": "pca-case-studies",
  "branchName": "ralph/pca-case-studies",
  "description": "Add case study support for PCA certification exam preparation",
  "userStories": [
    {
      "id": "US-001",
      "title": "Add CaseStudy Type to Shared Package",
      "description": "As a developer, I need shared TypeScript types for case studies so both client and server can use consistent interfaces.",
      "acceptanceCriteria": [
        "Add CaseStudy interface to packages/shared/src/index.ts",
        "Add CaseStudyWithCertification interface (includes certification details)",
        "Add caseStudyId?: number optional field to Question interface",
        "Add caseStudy?: CaseStudy optional field to QuestionWithDomain interface",
        "Add API request/response types: GetCaseStudiesResponse, GetCaseStudyResponse",
        "Add caseStudyId?: number to GenerateQuestionsRequest interface",
        "Export all new types",
        "Typecheck passes (npm run build -w @ace-prep/shared)"
      ],
      "priority": 1,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-002",
      "title": "Add CaseStudies Database Schema",
      "description": "As a developer, I need a database schema for case studies with a migration that preserves existing data.",
      "acceptanceCriteria": [
        "Add caseStudies table to packages/server/src/db/schema.ts with fields: id, certificationId (FK), code, name, companyOverview, solutionConcept, existingTechnicalEnvironment, businessRequirements (JSON), technicalRequirements (JSON), executiveStatement, orderIndex, createdAt",
        "Add nullable caseStudyId column to existing questions table",
        "Create migration file 0003_add_case_studies.ts that creates case_studies table and adds case_study_id column to questions (nullable, no data loss)",
        "Export Drizzle types: CaseStudy, NewCaseStudy",
        "Typecheck passes"
      ],
      "priority": 2,
      "passes": true,
      "notes": "Migration must be additive only - no drops, no data modifications"
    },
    {
      "id": "US-003",
      "title": "Seed PCA Case Study Data",
      "description": "As a developer, I need to seed the 4 official PCA case studies from the PDF documentation.",
      "acceptanceCriteria": [
        "Create packages/server/src/db/seedCaseStudies.ts with data for: Cymbal Retail, EHR Healthcare, Altostrat Media, KnightMotives Automotive",
        "Each case study includes all sections: overview, solution concept, technical environment, business requirements, technical requirements, executive statement",
        "Seed script is idempotent (checks for existing data before inserting)",
        "Add npm script db:seed-case-studies to server package.json",
        "Update db:setup script to call case study seeding",
        "Typecheck passes"
      ],
      "priority": 3,
      "passes": true,
      "notes": "Case study content from docs/pca/*.pdf files"
    },
    {
      "id": "US-004",
      "title": "Create Case Studies API Routes",
      "description": "As a developer, I need API endpoints to fetch case studies.",
      "acceptanceCriteria": [
        "Create packages/server/src/routes/caseStudies.ts with GET /api/case-studies and GET /api/case-studies/:id routes",
        "Register routes in server index.ts",
        "Routes return properly typed responses matching shared types",
        "Include certification info in response (code, name)",
        "Typecheck passes"
      ],
      "priority": 4,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-005",
      "title": "Update Questions API for Case Study Support",
      "description": "As a developer, I need to update the questions API to support case study filtering and include case study data in responses.",
      "acceptanceCriteria": [
        "Update GET /api/questions to accept optional caseStudyId query param",
        "Update question responses to include caseStudy field when present",
        "Update exam question responses to include case study reference",
        "Update study session question responses to include case study reference",
        "Ensure backward compatibility (questions without case studies still work)",
        "Typecheck passes"
      ],
      "priority": 5,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-006",
      "title": "Create Case Studies API Client",
      "description": "As a frontend developer, I need API client functions to fetch case studies.",
      "acceptanceCriteria": [
        "Add caseStudyApi object to packages/client/src/api/client.ts with getAll and getById functions",
        "Functions use proper authentication headers",
        "Functions handle errors consistently with existing API patterns",
        "Typecheck passes"
      ],
      "priority": 6,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-007",
      "title": "Create CaseStudyCard Component",
      "description": "As a user, I need a card component to display case study summaries in lists.",
      "acceptanceCriteria": [
        "Create packages/client/src/components/case-studies/CaseStudyCard.tsx",
        "Create CaseStudyCard.module.css with styling matching app design",
        "Card shows: name, company industry, key themes/technologies",
        "Card is clickable and links to detail view",
        "Displays certification badge",
        "Responsive design (works on mobile)",
        "Typecheck passes"
      ],
      "priority": 7,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-008",
      "title": "Create CaseStudyDetail Component",
      "description": "As a user, I need a detail component to view full case study content.",
      "acceptanceCriteria": [
        "Create packages/client/src/components/case-studies/CaseStudyDetail.tsx",
        "Create CaseStudyDetail.module.css",
        "Display all sections: Company Overview, Solution Concept, Technical Environment, Business Requirements, Technical Requirements, Executive Statement",
        "Include Practice Questions link to filter question bank",
        "Add back navigation",
        "Responsive design",
        "Typecheck passes"
      ],
      "priority": 8,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-009",
      "title": "Create CaseStudies Page",
      "description": "As a user, I need a dedicated page to browse and study case studies.",
      "acceptanceCriteria": [
        "Create packages/client/src/components/case-studies/CaseStudiesPage.tsx",
        "Create CaseStudiesPage.module.css",
        "Page lists all case studies for selected certification",
        "Shows message if certification has no case studies",
        "Uses TanStack Query for data fetching",
        "Shows loading and error states",
        "Create barrel export packages/client/src/components/case-studies/index.ts",
        "Typecheck passes"
      ],
      "priority": 9,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-010",
      "title": "Add Case Studies Route and Navigation",
      "description": "As a user, I need to access case studies from the navigation.",
      "acceptanceCriteria": [
        "Add /case-studies route to App.tsx",
        "Add /case-studies/:id route for detail view",
        "Add Case Studies to NAV_ITEMS in AppShell.tsx with icon",
        "Add Case Studies link to mobile bottom sheet",
        "Route only shows for certifications with case studies (PCA)",
        "Typecheck passes"
      ],
      "priority": 10,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-011",
      "title": "Add Case Study Link During Exams",
      "description": "As a user taking a practice exam, I need to see when a question references a case study and access it.",
      "acceptanceCriteria": [
        "Update ExamContainer.tsx to detect questions with caseStudyId",
        "Display case study name as a clickable badge/link above question text",
        "Link opens case study in new tab (/case-studies/:id)",
        "Style badge to be noticeable but not distracting",
        "Works for both exam and study session question displays",
        "Typecheck passes"
      ],
      "priority": 11,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-012",
      "title": "Update Question Generation for Case Studies",
      "description": "As a user, I want to generate AI questions that reference specific case studies.",
      "acceptanceCriteria": [
        "Update questionGenerator.ts to accept optional caseStudyId parameter",
        "When caseStudyId provided, fetch case study content and include in prompt",
        "Generated questions include caseStudyId in database insert",
        "Update question generation UI to optionally select case study (for PCA)",
        "Typecheck passes"
      ],
      "priority": 12,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-013",
      "title": "Add Case Study Filter to Question Browser",
      "description": "As a user, I want to filter the question bank by case study.",
      "acceptanceCriteria": [
        "Update QuestionBrowser.tsx to include case study filter dropdown",
        "Filter only appears when selected certification has case studies",
        "Selecting a case study filters questions to only those referencing it",
        "Include No case study option to see questions without case study reference",
        "Update QuestionFilterOptions type to include caseStudies array",
        "Typecheck passes"
      ],
      "priority": 13,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-014",
      "title": "Run Migration and Verify",
      "description": "As a developer, I need to run the migration and verify no data loss.",
      "acceptanceCriteria": [
        "Run migration against existing database with data",
        "Verify all existing questions still accessible",
        "Verify all existing exams/sessions still work",
        "Verify existing certifications, domains, topics unchanged",
        "Verify new case_studies table created",
        "Verify questions.case_study_id column added and nullable",
        "Typecheck passes",
        "npm run build succeeds"
      ],
      "priority": 14,
      "passes": true,
      "notes": "Final verification story"
    }
  ]
}
